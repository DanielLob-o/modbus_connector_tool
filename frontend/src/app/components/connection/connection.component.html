<div class="connection-container">
  <div class="card">
    <div class="header">
      <h2>Modbus Connect</h2>
      <div class="status" [class.connected]="isConnected" [class.error]="lastError">
        {{ statusMessage }}
      </div>
    </div>

    <div class="tabs">
      <button [class.active]="mode === 'TCP'" (click)="mode = 'TCP'">TCP</button>
      <button [class.active]="mode === 'RTU'" (click)="mode = 'RTU'">Serial (RTU)</button>
    </div>

    <div class="form-content" *ngIf="mode === 'TCP'">
      <div class="input-group">
        <label>Address (IP:Port)</label>
        <input type="text" [(ngModel)]="tcpAddress" placeholder="localhost:502">
      </div>
    </div>

    <div class="form-content" *ngIf="mode === 'RTU'">
      <div class="input-group">
        <label>COM Port</label>
        <input type="text" [(ngModel)]="rtuAddress" placeholder="COM1">
      </div>
      <div class="row">
        <div class="input-group">
          <label>Baud Rate</label>
          <select [(ngModel)]="baudRate">
            <option [ngValue]="9600">9600</option>
            <option [ngValue]="19200">19200</option>
            <option [ngValue]="115200">115200</option>
            <option [ngValue]="57600">57600</option>
          </select>
        </div>
        <div class="input-group">
          <label>Data Bits</label>
          <select [(ngModel)]="dataBits">
            <option [ngValue]="8">8</option>
            <option [ngValue]="7">7</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div class="input-group">
          <label>Stop Bits</label>
          <select [(ngModel)]="stopBits">
            <option [ngValue]="1">1</option>
            <option [ngValue]="2">2</option>
          </select>
        </div>
        <div class="input-group">
          <label>Parity</label>
          <select [(ngModel)]="parity">
            <option value="N">None</option>
            <option value="E">Even</option>
            <option value="O">Odd</option>
          </select>
        </div>
      </div>
    </div>

    <div class="actions">
      <button class="btn-primary" (click)="connect()" [disabled]="isLoading">
        {{ isLoading ? 'Connecting...' : 'Connect' }}
      </button>
      <button class="btn-secondary" (click)="disconnect()" *ngIf="isConnected">
        Disconnect
      </button>
    </div>
  </div>
</div>
